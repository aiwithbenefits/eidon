/* style.css */
html, body {
  margin: 0 !important;
  padding: 0 !important;
}

html {
  height: 100%;
}

body {
  min-height: 100%; 
  display: flex;    
  flex-direction: column; 
  background: var(--bg);
  color: var(--text);
  font-family: 'Inter', sans-serif;
  /* REMOVED padding-top related to fixed navbar */
  line-height: 1.6;
}

:root { 
--primary-color: #007bff;
--secondary-color: #6c757d;
--light-gray-rgb: 248, 249, 250;
--very-light-gray-rgb: 230, 230, 230;
--dark-gray: #343a40;
--bg: #f0f2f5;
--text: #333;
--container-bg: rgba(255, 255, 255, 0.9); /* Slightly more opaque for palette */
--card-shadow: 0 0.15rem 0.4rem rgba(0, 0, 0, 0.07);
--card-hover-shadow: 0 0.4rem 1rem rgba(0, 0, 0, 0.12);
--border-radius: 0.375rem;

/* Navbar Height Management Variables (NO LONGER NEEDED FOR FIXED NAVBAR PADDING) */
/* --navbar-content-base-height: 65px;  */
/* --navbar-buffer: 5px; */
/* --navbar-actual-height: calc(var(--navbar-content-base-height) + var(--navbar-buffer)); */
/* --navbar-wrapped-height-md: calc(var(--navbar-content-base-height) + 70px); */
/* --navbar-wrapped-height-sm: calc(var(--navbar-content-base-height) + 70px); */
/* --navbar-wrapped-height-xs: calc(var(--navbar-content-base-height) + 75px); */


--navbar-bg-opacity: 0.85; /* Kept if any element uses it, otherwise can remove */
--blur-intensity: 8px;
--card-bg-opacity: 0.9;
--input-bg: rgba(var(--light-gray-rgb), var(--card-bg-opacity));
--input-border-color: rgba(var(--very-light-gray-rgb), 0.5);
--text-muted-color: var(--secondary-color);
--link-color: var(--primary-color);
}

:root[data-theme="dark"] {
--primary-color: #0d6efd;
--secondary-color: #adb5bd;
--light-gray-rgb: 33, 37, 41;
--very-light-gray-rgb: 52, 58, 64; 
--dark-gray: #f8f9fa; 
--bg: #212529;
--text: #f8f9fa;
--container-bg: rgba(33, 37, 41, 0.95); /* Dark, slightly more opaque for palette */
--card-shadow: 0 0.15rem 0.4rem rgba(0, 0, 0, 0.15);
--card-hover-shadow: 0 0.4rem 1rem rgba(0, 0, 0, 0.25);
--input-bg: rgba(var(--very-light-gray-rgb), var(--card-bg-opacity));
--input-border-color: rgba(255,255,255,0.3);
--text-muted-color: var(--secondary-color);
--link-color: #4dabf7; 
}


/* --- OLD Navbar Styling (Comment out or remove) --- */
/*
.navbar { ... }
.navbar-content-wrapper { ... }
.navbar-brand { ... }
.navbar-logo { ... }
.search-form-wrapper { ... } // If not reused by palette
.search-input { ... } // If not reused by palette
.search-clear-btn { ... } // If not reused by palette
.navbar-buttons { ... }
*/

/* --- Command Palette Styling --- */
.command-palette-container {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.2); /* Softer backdrop */
  backdrop-filter: blur(4px);
  -webkit-backdrop-filter: blur(4px);
  display: none; /* Initially hidden, JS will use flex */
  align-items: flex-start; 
  justify-content: center;
  z-index: 1055; /* Ensure it's above Bootstrap modals (1050 default) */
  padding-top: 12vh; 
  opacity: 0;
  transition: opacity 0.15s ease-in-out;
}

.command-palette-container.visible {
  display: flex; /* Use flex when visible */
  opacity: 1;
}

.command-palette-content {
  background: var(--container-bg);
  padding: 1.25rem 1.5rem;
  border-radius: var(--border-radius);
  box-shadow: var(--card-shadow);
  width: 100%;
  max-width: 550px; 
  border: 1px solid var(--input-border-color);
  position: relative; 
  transform: translateY(-10px); /* Start slightly up for entry animation */
  transition: transform 0.15s ease-in-out;
}

.command-palette-container.visible .command-palette-content {
    transform: translateY(0);
}

/* Re-using search form wrapper and input styles, but scoped to palette */
.command-palette-content .search-form-wrapper {
  display: flex;
  margin: 0 0 0.75rem 0; 
  max-width: none; 
  position: relative;
}
.command-palette-content .search-input {
  flex-grow: 1;
  background: var(--input-bg);
  border: 1px solid var(--input-border-color);
  color: var(--text);
  box-shadow: var(--card-shadow); /* Simpler look in palette */
  border-radius: var(--border-radius);
  padding: 0.6rem 0.9rem;
  font-size: 1rem;
  padding-right: 2.5rem; /* For clear button */
}
.command-palette-content .search-input::placeholder { color: var(--secondary-color); opacity: 1; }
.command-palette-content .search-input:focus {
  background: var(--input-bg);
  color: var(--text);
  border-color: var(--primary-color);
  box-shadow: 0 0 0 0.2rem rgba(var(--primary-color), 0.25);
}

.command-palette-content .search-clear-btn {
  position: absolute;
  right: 0.5rem;
  top: 50%;
  transform: translateY(-50%);
  background: transparent;
  border: none;
  color: var(--secondary-color);
  cursor: pointer;
  padding: 0.25rem 0.5rem;
  display: none; 
  box-shadow: var(--card-shadow);
}
.command-palette-content .search-clear-btn:hover { color: var(--text); }

.command-palette-content .search-button {
  border-top-left-radius: 0;
  border-bottom-left-radius: 0;
}
.command-palette-content .search-input + .search-button { /* if input is directly before button */
   border-top-left-radius: 0;
   border-bottom-left-radius: 0;
}
.command-palette-content .search-input { /* if button is attached */
   border-top-right-radius: 0;
   border-bottom-right-radius: 0;
}


.palette-actions {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    /* border-top: 1px solid var(--input-border-color); */
    /* padding-top: 1rem; */
    /* margin-top: 1rem; */
}
.palette-action-btn {
    font-size: 0.875rem;
    padding: 0.4rem 0.8rem;
    box-shadow: var(--card-shadow);
}
.palette-action-btn i {
    margin-right: 0.4em;
    font-size: 0.9em;
}
.palette-action-btn .button-text {
    /* Style for text within buttons if needed */
}


.palette-close-btn {
    position: absolute;
    top: 0.5rem;
    right: 0.5rem;
    padding: 0.5rem; 
    line-height: 0.5;
}

:root[data-theme="dark"] .command-palette-container {
    background-color: rgba(10,10,10, 0.3); 
}
:root[data-theme="dark"] .command-palette-content {
    background: var(--bg); 
    border-color: rgba(255,255,255,0.15);
}
:root[data-theme="dark"] .command-palette-content .search-input {
    background: rgba(var(--very-light-gray-rgb),0.7);
    border-color: rgba(255,255,255,0.25);
}
:root[data-theme="dark"] .command-palette-content .search-input::placeholder {
    color: rgba(255,255,255,0.5);
}
:root[data-theme="dark"] .command-palette-content .search-input:focus {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 0.2rem rgba(var(--primary-color), 0.35);
}


#access-palette-hint-container {
    position: sticky; /* Try sticky to keep it at top of viewport until scrolled past */
    top: 0;
    z-index: 100; /* Below palette */
}
#access-palette-hint {
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
}
.palette-hint-logo {
    height: 80px; /* Adjust as needed */
    object-fit: contain;
    position: absolute;
    left: 0;
    top: 50%;
    transform: translateY(-50%);
}
#access-palette-hint kbd {
    padding: 0.1em 0.4em;
    border-radius: 3px;
    border: none;
    background-color: var(--container-bg);
    font-size: 0.85em;
    color: var(--text);
    box-shadow: var(--card-shadow);
}
:root[data-theme="dark"] #access-palette-hint {
    background-color: rgba(var(--light-gray-rgb), 0.3);
    border-bottom-color: none;
}
:root[data-theme="dark"] #access-palette-hint kbd {
    border-color: var(--secondary-color);
    background-color: var(--bg);
}


/* --- Main Content & Containers --- */
#mainContent {
  flex-grow: 1; 
  display: flex;    
  flex-direction: column; 
  width: 100%; 
  /* mt-4 from Bootstrap on #mainContent in base.html gives top margin */
}

/* Styles for timeline page content */
#mainContent > .slider-container { flex-shrink: 0; }
#mainContent > .image-container { 
  flex-grow: 1; display: flex; flex-direction: column;
  align-items: center; justify-content: center; 
  overflow: hidden; min-height: 0; padding: 1rem 0; 
}
.image-container #timestampImage {
  max-width: 90%; max-height: 60vh; object-fit: contain; 
  border-radius: var(--border-radius); box-shadow: var(--card-shadow);
  margin-bottom: 1rem; 
}
.image-container #imageMetadata {
  width: fit-content;
  max-width: 95%;
  margin-left: auto;
  margin-right: auto;
  text-align: left;
  overflow-y: auto;
  padding: 1rem;
  border-radius: var(--border-radius);
  background: rgba(var(--light-gray-rgb), 0.7);
  border: 1px solid var(--input-border-color);
  margin-top: 0.5rem;
  align-self: center;
  box-shadow: var(--card-shadow);
}
#mainContent > .alert.alert-info { 
  margin-top: auto; margin-bottom: auto;
  align-self: center; width: 80%; max-width: 600px; 
}
.container, .container-fluid { 
  padding-right: 15px; padding-left: 15px;
  margin-right: auto; margin-left: auto;
  box-shadow: var(--card-shadow);
}
@media (min-width: 1200px) { .container { max-width: 1140px; } }


/* --- Cards --- */
.eidon-card {
background-color: var(--container-bg); backdrop-filter: blur(var(--blur-intensity));
-webkit-backdrop-filter: blur(var(--blur-intensity)); border: 1px solid var(--input-border-color); 
border-radius: var(--border-radius); box-shadow: var(--card-shadow);
transition: transform 0.2s ease-out, box-shadow 0.2s ease-out; height: 100%;
display: flex; flex-direction: column; overflow: hidden; 
}
.eidon-card:hover { transform: translateY(-5px); box-shadow: var(--card-hover-shadow); }
.eidon-card-image-link { display: block; overflow: hidden; }
.eidon-card-img {
width: 100%; aspect-ratio: 16 / 9; object-fit: cover;
border-bottom: 1px solid var(--input-border-color); transition: transform 0.3s ease;
}
.eidon-card:hover .eidon-card-img { transform: scale(1.05); }
.card-body {
padding: 1rem; display: flex; flex-direction: column;
flex-grow: 1; background: transparent; 
}
.card-meta-info {
font-size: 0.8rem; background: rgba(var(--light-gray-rgb), 0.7);
color: var(--text); padding: 0.4rem 0.8rem; border-radius: var(--border-radius);
margin-bottom: 0.75rem; box-shadow: var(--card-shadow);
border: 1px solid var(--input-border-color);
}
.card-meta-info .app-icon { margin-right: 0.3rem; }
.card-title.eidon-card-title {
font-size: 1rem; font-weight: 600; color: var(--dark-gray); 
margin-bottom: 0.5rem; line-height: 1.3;
}
.card-text.eidon-card-url {
font-size: 0.8rem; word-break: break-all; margin-top: auto;
}
.card-text.eidon-card-url a { color: var(--link-color); text-decoration: none; }
.card-text.eidon-card-url a:hover { text-decoration: underline; }
.clamp-1-line { display: -webkit-box; -webkit-line-clamp: 1; -webkit-box-orient: vertical; overflow: hidden; text-overflow: ellipsis; }
.clamp-2-lines { display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; text-overflow: ellipsis; }


/* --- Image Viewer / Modal (Bootstrap Modal) --- */
.modal-content {
  border-radius: var(--border-radius); box-shadow: var(--card-shadow);
  background: var(--container-bg); backdrop-filter: blur(var(--blur-intensity));
  -webkit-backdrop-filter: blur(var(--blur-intensity)); border: 1px solid rgba(var(--very-light-gray-rgb), 0.7);
  display: flex; flex-direction: column; height: 90vh; overflow: hidden; 
}
.modal-header {
  background-color: rgba(var(--light-gray-rgb), 0.7); border-bottom: 1px solid var(--input-border-color);
  color: var(--dark-gray); flex-shrink: 0; 
}
.modal-title { font-weight: 500; }
.modal-body-fullscreen {
  padding: 0.5rem; overflow: auto; flex-grow: 1; flex-shrink: 1; flex-basis: 0;    
  min-height: 0; display: flex; align-items: center; justify-content: center; 
  scrollbar-width: thin; scrollbar-color: var(--secondary-color) rgba(var(--light-gray-rgb), 0.5);
}
.modal-body-fullscreen img {
  display: block; max-width: 100%; max-height: 100%; object-fit: contain; 
  margin: auto; border-radius: calc(var(--border-radius) - 0.1rem);
}
.modal-footer.metadata-footer {
  background-color: rgba(var(--light-gray-rgb), 0.7); border-top: 1px solid var(--input-border-color);
  font-size: 0.9rem; justify-content: flex-start; text-align: left;
  flex-wrap: wrap; flex-shrink: 0; overflow-y: auto; max-height: 15vh; 
}
.modal-footer.metadata-footer > div { width: 100%; }
.modal-footer.metadata-footer p { margin-bottom: 0.3rem; }
.modal-footer.metadata-footer strong { color: var(--dark-gray); } 
.modal-body-fullscreen::-webkit-scrollbar { width: 12px; }
.modal-body-fullscreen::-webkit-scrollbar-track { background: rgba(var(--light-gray-rgb), 0.5); border-radius: 6px; }
.modal-body-fullscreen::-webkit-scrollbar-thumb { background-color: var(--secondary-color); border-radius: 6px; border: 3px solid transparent; background-clip: content-box; }
.modal-body-fullscreen::-webkit-scrollbar-thumb:hover { background-color: var(--primary-color); }

/* --- Slider --- */
.slider-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 20px 15px;
  background: var(--container-bg);
  color: var(--text);
  backdrop-filter: blur(var(--blur-intensity));
  -webkit-backdrop-filter: blur(var(--blur-intensity));
  border-radius: var(--border-radius);
  box-shadow: var(--card-shadow);
  margin-bottom: 1.5rem;
  border: none;
}
.slider {
  width: 80%;
  padding: 0.2rem;
  border-radius: 999px;
  background: var(--container-bg);
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.25);
}
.slider-value {
  background: var(--container-bg); color: var(--text); padding: 0.25rem 0.5rem;
  border-radius: var(--border-radius); box-shadow: var(--card-shadow); margin-top: 0.5rem;
}

/* --- Filter Panel --- */
#filterPanel {
  background-color: var(--container-bg); backdrop-filter: blur(var(--blur-intensity));
  -webkit-backdrop-filter: blur(var(--blur-intensity)); padding: 1.5rem;
  border-radius: var(--border-radius); box-shadow: var(--card-hover-shadow);
  margin-top: 1rem; display: none; border: 1px solid var(--input-border-color);
}
#filterPanel h5 { margin-bottom: 1rem; font-weight: 500; }
#filterPanel .form-group label { font-weight: 500; font-size: 0.9rem; }

/* --- Alerts --- */
.alert-modern {
  border-left-width: 5px; border-radius: var(--border-radius); padding: 1rem 1.5rem;
  background-color: var(--container-bg); backdrop-filter: blur(var(--blur-intensity));
  -webkit-backdrop-filter: blur(var(--blur-intensity)); box-shadow: var(--card-shadow);
  border: 1px solid var(--input-border-color); border-left-style: solid; 
}
.alert-info.alert-modern { border-left-color: var(--primary-color); }
.alert-warning.alert-modern { border-left-color: #ffc107; }
.alert-modern .alert-heading { font-weight: 500; }

/* --- Utility & General --- */
.text-muted { color: var(--text-muted-color) !important; }
input, textarea { 
color: var(--text); background: var(--input-bg);
border: 1px solid var(--input-border-color); box-shadow: var(--card-shadow);
border-radius: var(--border-radius); padding: 0.5rem 0.75rem;
}
div.extracted-text-preview { 
  white-space: pre-wrap; overflow-y: auto; font-size: 0.85rem;
  line-height: 1.5; margin-top: 0.5rem; max-height: 100px; 
  padding: 0.5rem; background-color: rgba(0,0,0,0.03); 
  border-radius: calc(var(--border-radius) * 0.5);
  border: 1px solid rgba(var(--very-light-gray-rgb),0.7);
}

/* --- Dark Mode Overrides --- */
:root[data-theme="dark"] {
--input-bg: rgba(var(--very-light-gray-rgb), 0.8); 
--input-border-color: rgba(255, 255, 255, 0.25);

.image-container #imageMetadata {
  background: rgba(var(--light-gray-rgb), 0.85) !important; 
  border-color: rgba(255,255,255,0.2) !important; color: var(--text) !important;
}
.image-container #imageMetadata strong, 
.modal-footer.metadata-footer strong { color: var(--dark-gray) !important; }

.eidon-card { background-color: var(--container-bg) !important; border-color: rgba(255,255,255,0.15) !important; }
.eidon-card .card-body, .eidon-card .card-meta-info {
  background-color: rgba(var(--light-gray-rgb), 0.6) !important; 
  border-color: rgba(255,255,255,0.1) !important; color: var(--text) !important;
}
.eidon-card .card-meta-info span, .eidon-card .eidon-card-title, .eidon-card .card-text,
.eidon-card .eidon-card-url a, .eidon-card .card-meta-info .app-icon,
.eidon-card .card-meta-info .float-end { color: var(--text) !important; }
.eidon-card .eidon-card-url a:hover { color: var(--primary-color) !important; }

.modal-content { background: var(--container-bg) !important; border-color: rgba(255,255,255,0.2) !important; }
.modal-header {
    background-color: rgba(var(--light-gray-rgb), 0.85) !important; 
    border-bottom-color: rgba(255,255,255,0.25) !important; color: var(--dark-gray) !important; 
}
.modal-footer.metadata-footer {
  background: rgba(var(--light-gray-rgb), 0.85) !important;
  border-top-color: rgba(255,255,255,0.25) !important;
}
.modal-footer.metadata-footer p, .modal-footer.metadata-footer div { color: var(--text) !important; }
:root[data-theme="dark"] div.extracted-text-preview {
    background-color: rgba(var(--very-light-gray-rgb), 0.4);
    border-color: rgba(255,255,255,0.15);
}
.slider-value { background: rgba(var(--light-gray-rgb), 0.8); }
.modal-body-fullscreen::-webkit-scrollbar-track { background: rgba(var(--very-light-gray-rgb), 0.3); }
.modal-body-fullscreen::-webkit-scrollbar-thumb { background-color: var(--secondary-color); }
.modal-body-fullscreen::-webkit-scrollbar-thumb:hover { background-color: var(--primary-color); }
.modal-body-fullscreen { scrollbar-color: var(--secondary-color) rgba(var(--very-light-gray-rgb), 0.3); }
}

/* --- Responsive Adjustments (No longer need body padding-top changes for fixed navbar) --- */
@media (max-width: 991.98px) { /* md */
    .command-palette-content { max-width: 90%; }
}

@media (max-width: 767.98px) { /* sm */
  .eidon-card-img { aspect-ratio: 4 / 3; }
  .card-title.eidon-card-title { font-size: 0.9rem; }
  .modal-body-fullscreen { padding: 0.25rem; } 
  .image-container #imageMetadata { max-width: 95%; padding: 10px 15px; max-height: 25vh; }
  .image-container #timestampImage { max-height: 50vh; }
  #filterPanel { width: 100%; margin-left: 0; margin-right: 0; border-left: none; border-right: none; border-radius: 0;  }
  #access-palette-hint { font-size: 0.8rem; py: 1; }
}

@media (max-width: 575.98px) { /* xs */
  .command-palette-content { padding: 1rem; }
  .command-palette-content .search-input { font-size: 0.9rem; padding: 0.5rem 0.75rem; padding-right: 2.25rem;}
  .palette-actions { flex-direction: column; align-items: stretch;}
  .palette-action-btn { width: 100%; text-align: left; margin-bottom: 0.25rem;}
  .palette-action-btn i { margin-right: 0.75em; }

  .eidon-card-img { aspect-ratio: 3 / 2; } 
  .modal-body-fullscreen { padding: 0.1rem; } 
  .modal-footer.metadata-footer { font-size: 0.8rem; max-height: 20vh; }
  div.extracted-text-preview { font-size: 0.75rem; padding: 0.25rem; max-height: 80px; }
  .image-container #timestampImage { max-height: 45vh; }
  .image-container #imageMetadata { max-height: 20vh; font-size: 0.8rem; }
  .slider-container { padding: 15px 10px; margin-bottom: 1rem; }
  .slider-value { font-size: 0.85rem; }
}
/* --- Pause/Resume Button --- */
.pause-resume-btn {
  color: var(--text);
  opacity: 1;            /* Ensure full visibility */
  visibility: visible;   /* Ensure it's visible */
  display: inline;       /* Or block/flex as needed */
  pointer-events: auto !important;
  transition: none !important;
}
#imageMetadata .app-name {
  font-weight: 500;
  font-size: 0.9rem;
  color: var(--text);
}

/* App icon styling in image metadata */
#imageMetadata .metadata-app-info .app-icon {
  width: 20px;
  height: 20px;
  object-fit: contain;
  margin-right: 0.4rem;
  display: inline-block;
}